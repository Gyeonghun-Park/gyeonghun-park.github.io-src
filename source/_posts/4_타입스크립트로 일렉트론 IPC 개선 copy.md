---
title: 타입스크립트로 일렉트론 IPC 개선
date: 2023-10-5 12:11:09
tags: [Electron, Typescript, IPC, RPC]
---

</pre>

안녕하세요 감자입니다. 예전에 저는 업무로 게임 런처를 만들었을 때, 일렉트론을 사용했었습니다. 간단한 런처였기 때문에 일렉트론을 사용해서 구현하기 충분했었습니다. 일렉트론의 특징으로는 렌더러 프로세스(일반적으로 웹 페이지)와 메인 프로세스(Node.jsS 환경)이 분리되어 있다는 점입니다. 이 둘이 통신을 하기 위해서는 일렉트론은 IPC(Inter Process Communication) 사용하고 있습니다. 하지만 이 IPC를 일렉트론에서 사용하기위해 많은 보일러 플레이트(boilerplate) 코드를 작성해야합니다. 예를들어 백엔드 타입을 그대로 복제해 모든 프론트엔드에서 그대로 사용해야 하죠 **(나중에 수정)**. 저는 이과정이 상당히 번거롭고 유지보수가 어렵다고 느꼈습니다. 그래서 이번 포스팅에서는 타입스크립트를 이용해 일렉트론 IPC를 개선해보는 작업을 해보도록 하겠습니다.

## IPC란?

웹을 개발할때 우리는 `GET`, `POST`등 HTTP 메서드를 사용해 브라우저와 웹 서버 간에 정보를 교환하는 것이 익숙할 것입니다. 한 프로세스는 브라우저에서 실행되고 다른 프로세스는 서버에서 실행되며 데이터를 공유할때 사용하는 일반적인 프로토콜입니다. 하지만 동일한 컴퓨터에 있는 두 프로세스 간에도 데이터를 공유할때도 사용할수 있죠. 하지만, HTTP는 네트워크 레이어를 무조건 거쳐야하고 이는 보안 및 성능에 영향을 미칠 수 있습니다. 로컬 프로세스 간의 빠르고 효율적인 통신이 필요한 경우에는 IPC를 사용하는게 더 적합할수 있습니다.

일렉트론[(Electron)](https://www.electronjs.org/)은 두 프로세스가 모두 동일한 컴퓨터에 있는 경우에 해당합니다. 그래서 내부적을 IPC 채널을 통해 메시지를 수신하고 받는 매커니즘을 사용합니다. 이는 전통적인 IPC 메커니즘과는 살짝 다른데 내부적으로 Node.js의 이벤트 이미터(Event Emitter) 패턴을 사용하는 웹 기술에 기반한 자체적인 통신 방식이기 때문입니다.

## RPC란?

불행하게도 Electron의 IPC 메커니즘은 많은 보일러 플레이트코드가 필요하며 또한 얘기치 못한 오류의 주요 원인이라는 것을 알게되었습니다. 저는 이를 개선하기 위해 RPC 메커니즘을 도입하여 IPC를 개선하도록 시도하였습니다. RPC(Remote Procedure Call)는 분산 컴퓨팅 환경에서 널리 사용되는 통신 메커니즘이지만, 로컬 프로세스 간 통신에 사용될 경우 네트워크 레이어를 사용하는 대신 IPC의 형태를 취할 수 있습니다. RPC의 핵심 목적은 통신의 복잡성을 숨기고, 프로그래머가 원격 프로시저 또는 함수를 호출을 쉽게 구현할 수 있도록 하는것입니다. 우리의 경우, 함수들이 객체의 메소드들이므로 RMI(Remote Method Invocation) 매커니즘으로 구현 해볼것입니다.

## RPC 구현

### 생각해볼점

저는 원격으로 호출 가능한 서버측 메서드를 구현할 때 클라이언트의 간단한 코드가 즉시 해당 메서드를 호출 할수 있도록 만들고 싶습니다. 이를 위해선 정통적인 RPC 스텁(stub)이라 불리는 구성 요소를 작성해야합니다. 하지만 저는 복잡한 스텁을 생성하고 클라이언트 스텁과 서버 스텁을 연결하는 추가 단계를 거치고 싶지 않습니다. 어떻게 하면 좋을까요? 서버측의 객체를 클라이언트 상으로 import할수 있겠지만, 이는 해당 객체가 의존하는 모든 서버측 코드가 클라이언트에게 노출되는 것을 의미합니다. 보안상의 이유로 이는 바람직하지 않으므로 좋지 않은 방법입니다.

그래서 우리는 여기서 타입스크립트의 `import type` 구문을 사용해 실행 코드를 가져오지 않고 타입 정보만 가져오는 방법을 사용 해볼것입니다. 이 타입 정보에는 메서드 이름, 매개 변수 및 반환 값의 타입이 포함되므로 클라이언트측에서 간단한 스텁을 구현할때 사용하기 좋다고 판단했습니다.
