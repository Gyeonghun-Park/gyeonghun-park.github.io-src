---
title: "[Clean Code]í´ë¦°ì½”ë“œ 7ì¥ ì˜ˆì™¸ ì²˜ë¦¬"
tags: [Book]
toc: true
widgets:
  - type: toc
    position: left
  - type: categories
    position: right
cover: /img/clean_code.jpeg
date: 2022-02-05 12:11:40
categories: [Book]
---

</pre>
<!--more-->

<!--more-->

## **7ì¥ ì˜ˆì™¸ ì²˜ë¦¬**

ğŸ”– `ì½ì€ ë²”ìœ„` : 6ì¥, ê°ì²´ì™€ ìë£Œ êµ¬ì¡° ~ 7ì¥, ì˜ˆì™¸ ì²˜ë¦¬

---

### **1. ì˜ˆì™¸ ì²˜ë¦¬ ë°©ì‹**

ì˜¤ë¥˜ ì½”ë“œë¥¼ ë¦¬í„´í•˜ì§€ ë§ê³  ì˜ˆì™¸ë¥¼ ë˜ì ¸ë¼

#### `try - catchë¡œ ì˜ˆì™¸ì²˜ë¦¬`

```java
public class DeviceController {
    // ...

    public void sendShutDown() {
        try {
            tryToShutDown();
        } catch (DeviceShutDownError e) {
            logger.log(e);
        }
    }

    private void tryToShutDown() throws DeviceShutDownError {
        DeviceHandle handle = getHandle(DEV1);
        DeviceRecord record = retrieveDeviceRecord(handle);

        pauseDevice(handle);
        clearDeviceWorkQueue(handle);
        closeDevice(handle);
    }

    private DeviceHandle getHandle(DeviceId id) {
        // ...
        throw new DeviceShutDownError("Invalid handle for: " + id.toString());
        // ...
    }

    // ...
}
```

---

### **2. Unchecked Exceptionì„ ì‚¬ìš©í•˜ë¼**

`checked Exceptionì´ ë‚˜ìœ ì´ìœ `

- íŠ¹ì • ë©”ì†Œë“œì—ì„œ checked exceptionì„ throwí•˜ê³  ìƒìœ„ ë©”ì†Œë“œì—ì„œ ê·¸ exceptionì„ catch í•œë‹¤ë©´, ëª¨ë“  ì¤‘ê°„ë‹¨ê³„ ë©”ì†Œë“œì— exceptionì„ throwsí•´ì•¼í•œë‹¤.
- ì´ëŠ” OCP(ê°œë°© íì‡„ ì›ì¹™)ìœ„ë°°ì´ë‹¤. ìƒìœ„ ë©”ì†Œë“œì—ì„œ í•˜ìœ„ ë ˆë²¨ ë©”ì†Œë“œì˜ ë””í…Œì¼ì— ëŒ€í•´ ì•Œì•„ì•¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- í•„ìš”í•œ ê²½ìš° checked exceptionì„ ì‚¬ìš©í•´ì•¼ ë˜ì§€ë§Œ, ì¼ë°˜ì ì¸ ê²½ìš° ë“ë³´ë‹¤ ì‹¤ì´ ë§ë‹¤.
- íŒŒì´ì¬, C#, C++, ë£¨ë¹„ëŠ” checked exceptionì„ ì§€ì›í•˜ì§€ ì•ŠìŒì—ë„ ì•ˆì •ì ì¸ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ êµ¬í˜„í•˜ê¸°ì— ë¬´ë¦¬ê°€ ì—†ë‹¤.

---

### **3. Exception ì˜ ì“°ê¸°**

#### `ì˜ˆì™¸ì— ë©”ì‹œì§€ë¥¼ ë‹´ì•„ë¼`

- ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì›ì¸ê³¼ ìœ„ì¹˜ë¥¼ ì°¾ê¸° ì‰½ë„ë¡, ì˜ˆì™¸ë¥¼ ë˜ì§ˆ ë•ŒëŠ” ì „í›„ ìƒí™©ì„ ì¶©ë¶„íˆ ë§ë¶™ì¸ë‹¤.
- ì‹¤íŒ¨í•œ ì—°ì‚° ì´ë¦„ê³¼ ìœ í˜• ë“± ì •ë³´ë¥¼ ë‹´ì•„ ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.

#### `exception wrapper`

ì˜ˆì™¸ë¥¼ ê°ì‹¸ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤

- port.open() ì‹œ ë°œìƒí•˜ëŠ” checked exceptionë“¤ì„ ê°ì‹¸ë„ë¡ portë¥¼ ê°€ì§€ëŠ” LocalPort í´ë˜ìŠ¤ë¥¼ ë§Œë“ ë‹¤.
- port.open()ì´ ë˜ì§€ëŠ” checked ë“¤ì„ í•˜ë‚˜ì˜ PortDeviceFailure exceptionìœ¼ë¡œ ê°ì‹¸ì„œ ë˜ì§„ë‹¤.

ë‚˜ìœ ì˜ˆ

```java
ACMEPort port = new ACMEPort(12);
try {
  port.open();
} catch (DeviceResponseException e) {
  reportPortError(e);
  logger.log("Device response exception", e);
} catch (ATM1212UnlockedException e) {
  reportPortError(e);
  logger.log("Unlock exception", e);
} catch (GMXError e) {
  reportPortError(e);
  logger.log("Device response exception", e);
}
```

ì¢‹ì€ ì˜ˆ

```java
LocalPort port = new LocalPort(12);
try {
  port.open();
} catch (PortDeviceFailure e) {
  reportError(e);
  logger.log(e.getMessage(), e);
} finally {
  ...
}

public class LocalPort {
    private ACMEPort innerPort;

    public LocalPort(int portNumber) {
        innerPort = new ACMEPort(portNumber);
    }

    public void open() {
        try {
            innerPort.open();
        } catch (DeviceResponseException e) {
            throw new PortDeviceFailure(e);
        } catch (ATM1212UnlockedException e) {
            throw new PortDeviceFailure(e);
        } catch (GMXError e) {
            throw new PortDeviceFailure(e);
        }
    }

    // ..
}
```

---

### **4. ì‹¤ë¬´ ì˜ˆì™¸ ì²˜ë¦¬ íŒ¨í„´**

#### `getOrElse`

ì˜ˆì™¸ ëŒ€ì‹  ê¸°ë³¸ ê°’ì„ ë¦¬í„´í•œë‹¤.

- nullì´ ì•„ë‹Œ ê¸°ë³¸ ê°’
- ë„ë©”ì¸ì— ë§ëŠ” ê¸°ë³¸ ê°’

##### `nullì´ ì•„ë‹Œ ê¸°ë³¸ ê°’ ì˜ˆì œ`

ë‚˜ìœ ì˜ˆ

```java
List<Employee> employees = getEmployees();
if (employee != null) {
    for(Employee e : employees) {
        totalPay += e.getPay();
    }
}
```

- nullì„ ë¦¬í„´í•œë‹¤ë©´, ì´í›„ ì½”ë“œì—ì„œë„ ëª¨ë‘ null ì²´í¬ê°€ ìˆì–´ì•¼ í•œë‹¤.

ì¢‹ì€ ì˜ˆ

```java
List<Employee> employees = getEmployees();
for(Employee e : employees) {
    totalPay += e.getPay();
}

public List<Employee> getEmployees() {
    if ( /*.. ì§ì›ì´ ì—†ì„ ê²½ìš° .. */) {
        return Collections.emptyList();
    }
}
```

- ë³µìˆ˜ í˜•ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë–„ëŠ” ë°ì´í„°ê°€ ì—†ìŒì„ ì˜ë¯¸í•˜ëŠ” ì»¬ë ‰ì…˜ì„ ë¦¬í„´í•˜ë©´ ëœë‹¤.
- null ë³´ë‹¤ sizeê°€ 0ì¸ ì»¬ë ‰ì…˜ì´ í›¨ì”¬ ì•ˆì „í•˜ë‹¤.

##### `ë„ë©”ì¸ì— ë§ëŠ” ê¸°ë³¸ ê°’ ì˜ˆì œ`

ë‚˜ìœ ì˜ˆ

```java
UserLevel userLevel = null;
try {
  User user = user.Repository.findByUserId(userId);
  userLevel = user.getUserLevel();
} catch (UserNotfoundException e) {
  userLevel = UserLevel.BASIC;
}
```

- í˜¸ì¶œë¶€ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í†µí•´ userLevel ê°’ì„ ì²˜ë¦¬í•œë‹¤.
- ì½”ë“œë¥¼ ê³„ì† ì½ì–´ë‚˜ê°€ë©´ì„œ ë…¼ë¦¬ì ì¸ íë¦„ì´ ëŠê¸´ë‹¤.

ì¢‹ì€ ì˜ˆ

```java
public class UserService {
  public static final UserLevel USER_BASIC_LEVEL = UsrLevel.BASIC;

  public UserLevel getUserLevelOrdefault(Long userId) {
    try {
      User user = userRepository.findByUserId(userId);
      return user.getUserLevel();
    } catch(UserNotFoundException e) {
      return USER_BASIC_LEVEL;
    }
  }
}

UserLevel userLevel = userService.getuserLevelOrDefault(userId);
```

í˜¸ì¶œë¶€ - ë‹¨ìˆœí•´ì§

- ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ìª½ì—ì„œ ì²˜ë¦¬í•´ í˜¸ì¶œë¶€ ì½”ë“œê°€ ì‹¬í”Œí•´ì§„ë‹¤.
- ì½”ë“œë¥¼ ì½ì–´ê°€ë©° ë…¼ë¦¬ì ì¸ íë¦„ì´ ëŠê¸°ì§€ ì•ŠëŠ”ë‹¤.
- ë„ë©”ì¸ì— ë§ëŠ” ê¸°ë³¸ ê°’ì„ ë„ë©”ì¸ ì„œë¹„ìŠ¤ì—ì„œ ê´€ë¦¬í•œë‹¤.

#### `getOrElseThrow`

##### `(ê¸°ë³¸ ê°’ì´ ì—†ë‹¤ë©´) null ëŒ€ì‹  ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤`

ë‚˜ìœ ì˜ˆ

```java
User user = userRepository.findByUseId(userId);
if (user != null) {
  // userë¥¼ ì´ìš©í•œ ì²˜ë¦¬
}
```

- userë¥¼ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ë§¤ë²ˆ ì²´í¬ë¥¼ í•´ì•¼í•œë‹¤.
- ê°€ë…ì„± ë¿ë§Œ ì•„ë‹ˆë¼ ì•ˆì •ì„±ë„ ë–¨ì–´ì§„ë‹¤.
- null ì²´í¬ê°€ ë¹ ì§„ ë¶€ë¶„ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

ì¢‹ì€ ì˜ˆ

```java
public class UserService {
  public static final UserLevel USER_BASIC_LEVEL = UsrLevel.BASIC;

  public User getUserOrElseThrow(Long userId) {
    User user = userRepository.findByUserId(userId);
    if (user == null) {
      throw new IllegalArgumentException("User is not found. userId = " + userId)
    }
    return user;
    }
  }

User user = user.Service.getUserOrElseThrow(userId);
```

- ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ìª½ì—ì„œ null ì²´í¬ë¥¼ í•˜ì—¬, ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°ì—” ì˜ˆì™¸ë¥¼ ë˜ì§„ë‹¤.
- í˜¸ì¶œë¶€ì—ì„œ ë§¤ë²ˆ null ì²´í¬ë¥¼ í•  í•„ìš” ì—†ì´ ì•ˆì „í•˜ê²Œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- í˜¸ì¶œë¶€ì˜ ê°€ë…ì„±ì´ ì˜¬ë¼ê°„ë‹¤.

##### `íŒŒë¼ë¯¸í„°ì˜ nullì„ ì ê²€í•˜ë¼`

ë‚˜ìœ ì˜ˆ

```java
public class MetricsCalculator {
  public double xProjection(Point p1, Point p2) {
    return (p2.x - p1.x) * 1.5;
  }
}

// calculator.xProjection(null, new Point(12, 13));
// NullPointerException ë°œìƒ
```

- nullì„ ë¦¬í„´í•˜ëŠ” ê²ƒë„ ë‚˜ì˜ì§€ë§Œ nullì„ ë©”ì„œë“œë¡œ ë„˜ê¸°ëŠ” ê²ƒì€ ë” ë‚˜ì˜ë‹¤.
- nullì„ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ë„£ì–´ì•¼ í•˜ëŠ” APIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë©´ nullì„ ë©”ì„œë“œë¡œ ë„˜ê¸°ì§€ ë§ˆë¼.

ì¢‹ì€ ì˜ˆ - throw new ~ ì‚¬ìš©

```java
public class MetricsCalculator {
  public double xProjection(Point p1, Point p2) {
    if (p1 == null || p2 == null) {
      throw InvalidArgumentException("Invalid argument for MetricsCalculator.xProjection");
    }
    return (p2.x - p1.x) * 1.5;
  }
}
```

- nullì´ ë“¤ì–´ì˜¤ë©´ unchecked exceptionì„ ë°œìƒì‹œí‚¨ë‹¤.
- ì‹¤ë¬´ì—ì„œëŠ” assertë³´ë‹¤ ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” ë°©ë²•ì„ í›¨ì”¬ ë§ì´ ì‚¬ìš©í•œë‹¤.

ì¢‹ì€ ì˜ˆ - assert ì‚¬ìš©

```java
public class MetricsCalculator {
  public double xProjection(Point p1, Point p2) {
    assert p1 != null : "p1 should not be null";
    assert p2 != null : "p2 should not be null";
    return (p2.x - p1.x) * 1.5;
  }
}
```

##### `ì‹¤ë¬´ì—ì„œëŠ” ë³´í†µ ìì‹ ì˜ ì˜ˆì™¸ë¥¼ ì •ì˜í•œë‹¤`

```java
public class MyProjectException extends RuntimeException {
  private MyErrorCode errorCode;
  private String errorMessage;

  public MyProjectException(MyErrorCode errorCode) {
    //
  }

  public MyProjectException(MyErrorCode errorCode, String errorMessage) {
    //
  }
}

public enum MyErrorCode {
  private String defaultErrorMessage;

  INVALID_REQUEST("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤."),
  DUPLICATED_REQUEST("ê¸°ì¡´ ìš”ì²­ê³¼ ì¤‘ë³µë˜ì–´ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."),
  // ...
  INTERNAL_SERVER_ERROR("ì²˜ë¦¬ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
}

//í˜¸ì¶œë¶€
if (request.getUserName() == null) {
  throw new MyProjectException(ErrorCode.INVALID_REQUEST, "userName is null");
}
```

- ì—ëŸ¬ ë¡œê·¸ì—ì„œ stacktrace í•´ë´¤ì„ ë•Œ ìš°ë¦¬ê°€ ë°œìƒì‹œí‚¨ ì˜ˆì™¸ë¼ëŠ” ê²ƒì„ ë°”ë¡œ ì¸ì§€í•  ìˆ˜ ìˆë‹¤.
- ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ì™€ ì„ì´ì§€ ì•ŠëŠ”ë‹¤. ìš°ë¦¬ë„ IllegalArgumentExceptionì„ ë˜ì§€ëŠ” ê²ƒë³´ë‹¤ ìš°ë¦¬ ì˜ˆì™¸ë¡œ ë˜ì§€ëŠ”ê²Œ ì–´ëŠ ë¶€ë¶„ì—ì„œ ì—ëŸ¬ê°€ ë‚¬ëŠ”ì§€ íŒŒì•…í•˜ê¸°ì— ìš©ì´í•˜ë‹¤.
- ìš°ë¦¬ ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•œ ì—ëŸ¬ì˜ ì¢…ë¥˜ë¥¼ ë‚˜ì—´í•  ìˆ˜ ìˆë‹¤.
